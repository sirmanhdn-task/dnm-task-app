<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>DNM's Tasker v1.6.1 – Magnet Timeline</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="format-detection"
      content="telephone=no,time=no,date=no,address=no"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="page-bg"></div>

    <div class="app-shell">
      <!-- HEADER -->
      <header class="app-header card-glass">
        <div class="app-title-block">
          <div class="logo-orb"></div>
          <div class="title-texts">
            <span class="title-main">DNM's Tasker</span>
            <span class="title-sub">v1.6.1 · Magnet timeline · Firebase</span>
          </div>
        </div>

        <div class="header-right">
          <button id="loginBtn" class="btn secondary-btn">
            Sign in with Google
          </button>

          <div id="userInfo" class="user-info" style="display: none">
            <img id="userAvatar" class="user-avatar" alt="avatar" />

            <div class="user-text">
              <span id="userEmail" class="user-email"></span>
              <span class="user-status">Premium-ready</span>
            </div>

            <button id="logoutBtn" class="btn ghost-btn">Sign out</button>
          </div>
        </div>
      </header>

      <!-- TABS -->
      <nav class="tab-bar card-soft">
        <button id="tabTimeline" class="tab-btn active">Timeline</button>
        <button id="tabBackground" class="tab-btn">Background</button>
        <button id="tabSettings" class="tab-btn">Settings</button>
      </nav>

      <!-- MAIN CONTENT -->
      <main class="app-main card-main">
        <!-- ===================== -->
        <!-- TIMELINE TAB -->
        <!-- ===================== -->
        <section id="timelineTab" class="tab-content active">
          <header class="section-header">
            <div>
              <h1 class="section-title">Timeline</h1>
              <p class="section-subtitle">
                Automatically generated schedule based on NOW-centric engine.
              </p>
            </div>
          </header>

          <section class="timeline-shell card-soft">
            <header id="timelineHeader" class="timeline-header"></header>
            <div id="timelineCanvas" class="timeline-canvas"></div>
          </section>

          <section class="panel-grid">
            <!-- Main tasks form -->
            <div class="panel-main card-soft">
              <header class="panel-header">
                <div>
                  <h2>Main tasks</h2>
                  <p>Create work that the engine will place automatically.</p>
                </div>
              </header>

              <form id="mainTaskForm" class="form-grid">
                <div class="form-row">
                  <label>Title</label>
                  <input type="text" id="mtTitle" required />
                </div>

                <div class="form-row">
                  <label>Description</label>
                  <textarea id="mtDescription" rows="2"></textarea>
                </div>

                <div class="form-row">
                  <label>Duration (minutes)</label>
                  <input
                    type="number"
                    id="mtDuration"
                    min="1"
                    step="1"
                    required
                  />
                </div>

                <div class="form-row">
                  <label>Deadline</label>
                  <input type="datetime-local" id="mtDeadline" required />
                </div>

                <div class="form-row">
                  <label class="pill-label">Mode</label>
                  <div class="pill-group" id="mtModeGroup">
                    <button
                      type="button"
                      data-value="NONE"
                      class="pill active"
                    >
                      Normal
                    </button>
                    <button type="button" data-value="ONLY" class="pill">
                      ONLY
                    </button>
                    <button type="button" data-value="PREFER" class="pill">
                      PREFER
                    </button>
                  </div>
                </div>

                <div class="form-row">
                  <label>Days (ONLY/PREFER)</label>
                  <div class="pill-group pill-wrap" id="mtDayPills">
                    <button type="button" data-day="0" class="pill">Sun</button>
                    <button type="button" data-day="1" class="pill">Mon</button>
                    <button type="button" data-day="2" class="pill">Tue</button>
                    <button type="button" data-day="3" class="pill">Wed</button>
                    <button type="button" data-day="4" class="pill">Thu</button>
                    <button type="button" data-day="5" class="pill">Fri</button>
                    <button type="button" data-day="6" class="pill">Sat</button>
                  </div>
                </div>

                <div class="form-row">
                  <label>Time windows (3h blocks)</label>
                  <div class="pill-group pill-wrap" id="mtSlotPills">
                    <button type="button" data-slot="0" class="pill">
                      00–03
                    </button>
                    <button type="button" data-slot="1" class="pill">
                      03–06
                    </button>
                    <button type="button" data-slot="2" class="pill">
                      06–09
                    </button>
                    <button type="button" data-slot="3" class="pill">
                      09–12
                    </button>
                    <button type="button" data-slot="4" class="pill">
                      12–15
                    </button>
                    <button type="button" data-slot="5" class="pill">
                      15–18
                    </button>
                    <button type="button" data-slot="6" class="pill">
                      18–21
                    </button>
                    <button type="button" data-slot="7" class="pill">
                      21–24
                    </button>
                  </div>
                </div>

                <div class="form-row">
                  <label>Pending until (optional)</label>
                  <input type="datetime-local" id="mtPendingUntil" />
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn primary-btn">
                    Add main task
                  </button>
                </div>
              </form>
            </div>

            <!-- Main tasks list -->
            <div class="panel-main card-soft">
              <header class="panel-header">
                <div>
                  <h2>Main task list</h2>
                  <p>All your added tasks (active, pending, overdue).</p>
                </div>
              </header>

              <div id="mainTaskList" class="task-list"></div>
            </div>
          </section>
        </section>

        <!-- ===================== -->
        <!-- BACKGROUND TAB -->
        <!-- ===================== -->
        <section id="backgroundTab" class="tab-content">
          <header class="section-header">
            <div>
              <h1 class="section-title">Background tasks</h1>
              <p class="section-subtitle">
                Fixed blocks (sleep, office hours, etc.) that fully block main
                tasks.
              </p>
            </div>
          </header>

          <section class="panel-grid single">
            <!-- BG Task Create -->
            <div class="panel-main card-soft">
              <header class="panel-header">
                <div>
                  <h2>Create background task</h2>
                  <p>Define when your time is not available for main work.</p>
                </div>
              </header>

              <form id="bgTaskForm" class="form-grid">
                <div class="form-row">
                  <label>Title</label>
                  <input type="text" id="bgTitle" required />
                </div>

                <div class="form-row">
                  <label>Description</label>
                  <textarea id="bgDescription" rows="2"></textarea>
                </div>

                <div class="form-row two-cols">
                  <div>
                    <label>Start</label>
                    <input type="datetime-local" id="bgStart" required />
                  </div>

                  <div>
                    <label>End</label>
                    <input type="datetime-local" id="bgEnd" required />
                  </div>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn primary-btn">
                    Add background task
                  </button>
                </div>
              </form>
            </div>

            <!-- BG List -->
            <div class="panel-main card-soft">
              <header class="panel-header">
                <div>
                  <h2>Background task list</h2>
                  <p>
                    Active blocking windows within your horizon (expired
                    auto-removed).
                  </p>
                </div>
              </header>

              <div id="bgTaskList" class="task-list"></div>
            </div>
          </section>
        </section>

        <!-- ===================== -->
        <!-- SETTINGS TAB -->
        <!-- ===================== -->
        <section id="settingsTab" class="tab-content">
          <header class="section-header">
            <div>
              <h1 class="section-title">Settings</h1>
              <p class="section-subtitle">
                Adjust engine parameters (advanced users only).
              </p>
            </div>
          </header>

          <section class="panel-grid single">
            <div class="panel-main card-soft">
              <form id="settingsForm" class="form-grid">
                <div class="form-row">
                  <label>Slice minutes</label>
                  <input
                    type="number"
                    id="setSliceMinutes"
                    min="5"
                    max="60"
                    required
                  />
                </div>

                <div class="form-row">
                  <label>Timeline horizon (days)</label>
                  <input
                    type="number"
                    id="setHorizonDays"
                    min="1"
                    max="30"
                    required
                  />
                </div>

                <div class="form-row">
                  <label>kShort multiplier</label>
                  <input type="number" id="setKShort" step="0.1" required />
                </div>

                <div class="form-row">
                  <label>kOnlyPrefer multiplier</label>
                  <input type="number" id="setKOnlyPrefer" step="0.1" required />
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn primary-btn">
                    Save settings
                  </button>
                </div>
              </form>
            </div>
          </section>
        </section>
      </main>
    </div>

    <!-- TOOLTIP -->
    <div id="tooltipTask" class="tooltip-task" style="display: none"></div>

    <!-- EDIT MAIN TASK MODAL -->
    <div id="editTaskModal" class="modal-overlay" style="display: none">
      <div class="modal-card">
        <h2>Edit task</h2>
        <form id="editTaskForm" class="form-grid">
          <div class="form-row">
            <label>Title</label>
            <input type="text" id="editTitle" required />
          </div>

          <div class="form-row">
            <label>Description</label>
            <textarea id="editDescription" rows="2"></textarea>
          </div>

          <div class="form-row">
            <label>Duration (minutes)</label>
            <input
              type="number"
              id="editDuration"
              min="1"
              step="1"
              required
            />
          </div>

          <div class="form-row">
            <label>Deadline</label>
            <input type="datetime-local" id="editDeadline" required />
          </div>

          <div class="form-row">
            <label>Pending until</label>
            <input type="datetime-local" id="editPendingUntil" />
          </div>

          <div class="modal-actions">
            <button type="button" id="editCancel" class="btn ghost-btn">
              Cancel
            </button>
            <button type="submit" class="btn primary-btn">Save</button>
          </div>
        </form>
      </div>
    </div>

    <!-- DUPLICATE ACTION SHEET -->
    <div id="duplicateSheet" class="modal-overlay" style="display: none">
      <div class="modal-card">
        <h2>Duplicate task</h2>

        <div class="duplicate-options">
          <button data-offset="0" class="btn secondary-btn">
            Same deadline
          </button>
          <button data-offset="1" class="btn secondary-btn">+1 day</button>
          <button data-offset="3" class="btn secondary-btn">+3 days</button>
          <button data-offset="7" class="btn secondary-btn">+7 days</button>

          <button id="duplicateCustom" class="btn primary-btn">
            Custom date…
          </button>
        </div>
      </div>
    </div>

    <!-- CUSTOM DATE MODAL -->
    <div id="customDateModal" class="modal-overlay" style="display: none">
      <div class="modal-card">
        <h2>Select custom duplicate deadline</h2>

        <form id="customDateForm" class="form-grid">
          <div class="form-row">
            <label>Deadline</label>
            <input type="datetime-local" id="customDateInput" required />
          </div>

          <div class="modal-actions">
            <button type="button" id="customCancel" class="btn ghost-btn">
              Cancel
            </button>
            <button type="submit" class="btn primary-btn">Duplicate</button>
          </div>
        </form>
      </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast"></div>

    <script src="app.js"></script>
  </body>
</html>
